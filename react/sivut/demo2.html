<html lang="fi">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <link rel="stylesheet" href="../../style/css/style_ok.css">

    <title>Fullstack-kehitys</title>
</head>

<body>
    <div class="wrapper">
        <a href="../index.html">
        <header>
            <h1>Fullstack-kehitys</h1>
        </header>
        </a>
        <div id="container">

            <div id="main" role="main">

                <article class="markdown-body">
                    <h2>React-demoja</h2>
                    <h3>Demo 2</h3>
                    <p>Tämä demo käy läpi Full Stack open-kurssin <a
                            href="https://fullstackopen.com/osa1/komponentin_tila_ja_tapahtumankasittely" target="_blank">osan 1 kohdan Komponentin tila ja tapahtumankäsittely</a>.</p>
<h4>Tilamuuttuja</h4>
                            <p>Tila (state) on Reactin ominaisuus jolla voidaan määritellä komponentin eliaikana päivittyvä tieto. Tilamuuttujalla on kaksi alkota joista ensimmäinen on muuttuja ja toinen funktio jolla muuttujaa voidaan päivittää.</p>
                            <p>Lisää demot-projektissa <i>components</i>-kansioon uusi tiedosto <i>Counter.jsx</i>.</p>
                            <p>useState-funktio tulee importata tiedoston alussa: </p>
                            <pre>import { useState } from 'react'</pre>
                            <p>Tilamuuttuja(t) määritellään komponentin alussa. Tilamuuttujan alkuarvo määrittää muuttujan tyypin (esimerkiksi 0, "", false, []).</p>
<pre>
import { useState } from "react";

const Counter = () =&gt; {
    const [counter, setCounter] = useState(0);
    return (
        &lt;div&gt;
            &lt;p&gt;Counter: {counter}&lt;/p&gt;
        &lt;/div&gt;
    )
}

export default Counter;    
</pre>
<p>Nyt alkuarvo tulostuu sivulle. Kun halutaan päivittää muuttujaa <i>counter</i> meidän tulee kutsua setCounter-funktiota. Tehdään painike joka kasvattaa muuttujaa:</p>   
<pre>&lt;button onClick={() =&gt; setCounter(counter + 1)}&gt;Add&lt;/button&gt;</pre>
<p><img src="../kuvat/demot2_1.png" alt=""></p>
<p>Kokeile lisätä painike muuttujan arvon vähentämistä ja nollausta varten.</p>        

<hr>
<h4>Ehdollinen renderöinti</h4>
<p>Tilan avulla voidaan helposti hallita käyttöliittymää piilottamalla ja näyttämällä komponentti tai <i>div</i>-elementti tilamuuttujan mukaisesti.</p>
<p>Lisää <i>demot</i>-projektissa App.jsx-tiedostolle tilamuuttuja <i>showPets</i>.</p>
<pre>
function App() {
  const [showPets, setShowPets] = useState(false);    
</pre>
<p>Lisätään koodia Pets-komponentin ympärille. Jos showPets on <i>true</i> niin näytetään Pets-komponentti:</p>
<pre>{showPets && &lt;Pets pets={pets} /&gt;}</pre>
<p>Kokeile toimintaa. Lisää tämän jälkeen painike jolla voidaan muuttaa tilamuuttujan boolean-arvo päinvastaiseksi.</p>
<pre>&lt;button onClick={()=&gt;setShowPets(!showPets)}&gt;Show Pets&lt;/button&gt;</pre>
<p>Olisi näppärää jos teksti vaihtuisi myös. Voit kirjoittaa <i>Show Pets</i>-tekstin tilalle lyhyen ehtolauseen joka hyödyntää tilamuuttujaa:</p>
<pre>{showPets ? "Hide Pets" : "Show Pets"}</pre>

<hr>
<h4>Friends</h4>

<p>Seuraavaksi kokeillaan muuttujan lisäämistä taulukkoon. Lisää <i>components</i>-kansioon Friends.jsx-tiedosto.</p>
<pre>
const Friends = () =&gt; {
    const [name, setName] = useState("");

    return (
        &lt;div&gt;
            &lt;h2&gt;New Friend&lt;/h2&gt;
            &lt;form action="" &gt;
                &lt;input type="text" value={name} onChange={e =&gt; setName(e.target.value)} /&gt;
                &lt;button type="submit"&gt;Lisää&lt;/button&gt;
            &lt;/form&gt;
        &lt;/div&gt;
    )
}

export default Friends;    
</pre>
<p>Lomakkeella syötetty nimi tallennetaan name-tilamuuttujaan. Lisää App.jsx-tiedostossa Friends-komponentti:</p>
<pre>&lt;Friends /&gt;</pre>

<p>Kaveri on tarkoitus lisätä taulukkoon joten tälle tarvitaan Friends-komponentille (Friends.jsx) oma tilamuuttuja:</p>
<pre>const [friends, setFriends] = useState([]); </pre>

<p>Lomake kutsuu submitHandler-funktiota jossa uusi nimi lisätään concat-funktiolla friends-taulukon jatkeeksi.</p>
<pre>
const submitHandler = (e, name) =&gt; {
        e.preventDefault();
        setFriends(friends.concat(name))
        console.log(friends);
        setName("");
    }    
</pre>
<p>Lisää lomakkeelle kutsu funktiolle:</p>
<pre>&lt;form action="" onSubmit={e =&gt; submitHandler(e, name)} &gt;</pre>

<h4>FriendsList</h4>
<p>Taulukon tulostaminen tehdään omaan Komponenttiin <i>FriendsList</i>. Lisää tämä komponentti Friends.jsx-tiedostoon, et tarvitse sitä App.jsx-tiedostolla joten sen exportointi ei ole tarpeen.</p>

<pre>
const FriendsList = ({friends}) =&gt; {
    return (
        &lt;ul&gt;
            {friends.map((f,i) =&gt; &lt;li key={i}&gt;{f} &lt;/li&gt;)}
        &lt;/ul&gt;
    )
}    
</pre>

<p>FriendsList saa parametrina taulukon. Lisää Friends-komponentille listan näyttäminen mukaan:</p>
<pre>
&lt;h2&gt;Friends&lt;/h2&gt;
&lt;FriendsList friends={friends} /&gt;    
</pre>


<h4>Olioiden käsittely</h4>
<p>Tehdään <i>friends</i>-taulukon sisältämistä tiedoista hieman monimutkaisempia. Taulukko sisältäisi olioita joilla on nimi, id ja pisteet. Kun ystävä listään tälle arvotaan id.</p>
<pre>setFriends(friends.concat({name: name, points: 0, id: Math.floor(Math.random()*1000000)}));</pre>
<p><i>FriendsList</i>-komponentilla näytetään olion tiedot mapin sisällä:</p>
<pre>&lt;li key={f.id}&gt;nimi: {f.name} pisteet: {f.points}</pre>
<p>Pisteen lisäämistä varten tarvitaan funktio <i>addPoint</i>. Tilamuuttujaa ei voi muuttaa vaan se täytyy korvata uudella taulukolla. Tästä syystä tehdään aputaulukko <i>tempFriends</i> jossa oikealla id:llä oleva ystävä päivitetään. Lisää <i>addPoint</i>-funktio Friends-komponentille.</p>
<pre>
const addPoint = (e, id) =&gt; {
    e.preventDefault();
    const tempFriends = friends.map(f =&gt; {
        if(id === f.id)
            f = {...f, points: f.points + 1}
        return f
    })
    setFriends(tempFriends)
}    
</pre>
<p>Pisteen lisäämien tapahtuu FriendsList-komponentilla. Viedään <i>addPoint</i> toiselle komponentille:</p>
<pre>&lt;FriendsList friends={friends} addPoint={addPoint}/&gt;</pre>
<p>Jotta <i>FriendsList</i> osaa käyttää sitä täytyy funktio tuoda mukaan: </p>
<pre>const FriendsList = ({friends, addPoint}) =&gt; {</pre>
<p>Lisää vielä painike <i>li</i>-elementin sisälle:</p>
<pre>&lt;button onClick={e=&gt;addPoint(e, f.id)}&gt;lisää piste&lt;/button&gt;</pre>

<h4>Reduce</h4>

<p><i>Friends</i>-komponentilla voidaan näyttää kokonaispisteet <i>reduce</i>-funktion avulla. Tehdään aputaulukko <i>points</i> ja lasketaan siitä kokonaispisteet <i>reduce</i>-funktiolla:</p>
<pre>
const points = friends.map(f =&gt; f.points)
const totalPoints = points.reduce((a, b) =&gt; a + b, 0)    
</pre>
<p>Näytä return-osassa <i>totalPoints</i></p>
<pre>&lt;p&gt;Total points: {totalPoints}&lt;/p&gt;</pre>
<p><img src="../kuvat/demot2_2.png" alt=""></p>


</article>
            </div>
        </div>
    </div>
    <footer>
        <p>
            Ohjelmistokehittäjänä toimiminen | 2026</p>
    </footer>
</body>

</html>